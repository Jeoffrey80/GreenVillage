{% extends 'base.html.twig' %}

{% block title %}Accueil{% endblock %}

{% block body %}
<style>
    body {
        background-color: antiquewhite;
        font-family: Arial, sans-serif;
    }

    .welcome-container {
        text-align: center;
        padding: 50px 0;
    }

    .welcome-container h1 {
        font-size: 3em;
        font-weight: bold;
        color: #333;
    }

    .carousels-container {
        display: flex;
        justify-content: space-around;
        margin: 50px 0;
    }

    .carousel {
        width: 45%;
        background-color: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .carousel img {
        width: 100%;
        border-radius: 10px;
    }

    .carousel-indicators {
        display: flex;
        justify-content: center;
        margin-top: 10px;
    }

    .carousel-indicators button {
        background-color: #333;
        border: none;
        width: 10px;
        height: 10px;
        margin: 0 5px;
        border-radius: 50%;
        cursor: pointer;
    }

    .carousel-indicators button.active {
        background-color: #555;
    }
</style>

<div class="welcome-container">
    {% if app.user %}
        <h1>Bonjour {{ app.user.prenom }}</h1>
    {% else %}
        <h1>Bonjour Visiteur</h1>
    {% endif %}
</div>

<div class="carousels-container">
    <div id="carousel1" class="carousel">
        <div class="carousel-inner" id="carousel1-images">
            <!-- Images will be injected here by JavaScript -->
        </div>
        <div class="carousel-indicators" id="carousel1-indicators"></div>
    </div>

    <div id="carousel2" class="carousel">
        <div class="carousel-inner" id="carousel2-images">
            <!-- Images will be injected here by JavaScript -->
        </div>
        <div class="carousel-indicators" id="carousel2-indicators"></div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        fetch('{{ path("get_images") }}')
            .then(response => response.json())
            .then(images => {
                const carousel1Images = getRandomImages(images, 10);
                const carousel2Images = getRandomImages(images, 10);
                createCarousel('carousel1', carousel1Images);
                createCarousel('carousel2', carousel2Images);
            });

        function getRandomImages(images, count) {
            const shuffled = images.sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count);
        }

        function createCarousel(id, images) {
            const carouselImages = document.getElementById(`${id}-images`);
            const carouselIndicators = document.getElementById(`${id}-indicators`);
            
            images.forEach((image, index) => {
                // Create image element
                const imgElem = document.createElement('img');
                imgElem.src = '/' + image;
                imgElem.alt = `Product ${index + 1}`;
                imgElem.className = 'carousel-item' + (index === 0 ? ' active' : '');

                // Create indicator button
                const indicator = document.createElement('button');
                indicator.className = (index === 0 ? 'active' : '');
                indicator.addEventListener('click', () => {
                    document.querySelectorAll(`#${id} .carousel-item`).forEach(item => item.classList.remove('active'));
                    document.querySelectorAll(`#${id}-indicators button`).forEach(btn => btn.classList.remove('active'));
                    imgElem.classList.add('active');
                    indicator.classList.add('active');
                });

                carouselImages.appendChild(imgElem);
                carouselIndicators.appendChild(indicator);
            });
        }
    });
</script>
{% endblock %}
